/**
 * sp-pnp-js v1.0.0 - A reusable JavaScript library targeting SharePoint client-side development.
 * Copyright (c) 2016 Microsoft
 * MIT
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(t.$pnp||(t.$pnp={})).Provisioning=e()}}(function(){var e;return function t(e,n,o){function r(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return r(n?n:t)},l,l.exports,t,e,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../utils/util"],r)}(function(e,t){"use strict";var n=e("../utils/util"),o=function(){function e(){this.keys=[],this.values=[]}return e.prototype.get=function(e){var t=this.keys.indexOf(e);return 0>t?null:this.values[t]},e.prototype.add=function(e,t){var n=this.keys.indexOf(e);n>-1?this.values[n]=t:(this.keys.push(e),this.values.push(t))},e.prototype.merge=function(e){if(n.Util.isFunction(e.getKeys))for(var t=e,o=t.getKeys(),r=o.length,i=0;r>i;i++)this.add(o[i],t.get(o[i]));else{var s=e;for(var a in s)s.hasOwnProperty(a)&&this.add(a,e[a])}},e.prototype.remove=function(e){var t=this.keys.indexOf(e);if(0>t)return null;var n=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),n},e.prototype.getKeys=function(){return this.keys},e.prototype.getValues=function(){return this.values},e.prototype.clear=function(){this.keys=[],this.values=[]},e.prototype.count=function(){return this.keys.length},e}();t.Dictionary=o})},{"../utils/util":21}],2:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";function n(e){r.set(e)}var o=function(){function e(){this._headers=null}return e.prototype.set=function(e){e.hasOwnProperty("headers")&&(this._headers=e.headers)},Object.defineProperty(e.prototype,"headers",{get:function(){return this._headers},enumerable:!0,configurable:!0}),e}();t.RuntimeConfigImpl=o;var r=new o;t.RuntimeConfig=r,t.setRuntimeConfig=n})},{}],3:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./fetchClient","./digestCache","../utils/util","../configuration/pnplibconfig"],r)}(function(e,t){"use strict";var n=e("./fetchClient"),o=e("./digestCache"),r=e("../utils/util"),i=e("../configuration/pnplibconfig"),s=function(){function e(e){void 0===e&&(e=new n.FetchClient),this._impl=e,this._digestCache=new o.DigestCache(this)}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=this,o=r.Util.extend(t,{cache:"no-cache",credentials:"same-origin"},!0),s=new Headers;if(this.mergeHeaders(s,i.RuntimeConfig.headers),this.mergeHeaders(s,t.headers),s.has("Accept")||s.append("Accept","application/json"),s.has("Content-Type")||s.append("Content-Type","application/json;odata=verbose;charset=utf-8"),s.has("X-ClientService-ClientTag")||s.append("X-ClientService-ClientTag","SharePoint.PnP.JavaScriptCore"),o=r.Util.extend(o,{headers:s}),o.method&&"GET"!==o.method.toUpperCase()&&!s.has("X-RequestDigest")){var a=e.indexOf("/_api/");if(0>a)throw new Error("Unable to determine API url");var c=e.substr(0,a);return this._digestCache.getDigest(c).then(function(t){return s.append("X-RequestDigest",t),n.fetchRaw(e,o)})}return n.fetchRaw(e,o)},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var o=function(i){n._impl.fetch(e,t).then(function(e){return i.resolve(e)})["catch"](function(e){var t=i.delay;429!==e.status&&503!==e.status&&i.reject(e),i.delay*=2,i.attempts++,i.retryCount<=i.attempts&&i.reject(e),setTimeout(r.Util.getCtxCallback(n,o,i),t)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};o.call(n,r)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=r.Util.extend(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=r.Util.extend(t,{method:"POST"});return this.fetch(e,n)},e.prototype.mergeHeaders=function(e,t){if("undefined"!=typeof t){var n=new Request("",{headers:t});n.headers.forEach(function(t,n){e.append(n,t)})}},e}();t.HttpClient=s})},{"../configuration/pnplibconfig":2,"../utils/util":21,"./digestCache":4,"./fetchClient":5}],4:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../collections/collections","../utils/util","../sharepoint/rest/odata"],r)}(function(e,t){"use strict";var n=e("../collections/collections"),o=e("../utils/util"),r=e("../sharepoint/rest/odata"),i=function(){function e(){}return e}();t.CachedDigest=i;var s=function(){function e(e,t){void 0===t&&(t=new n.Dictionary),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,n=this._digests.get(e);if(null!==n){var s=new Date;if(s<n.expiration)return Promise.resolve(n.value)}var a=o.Util.combinePaths(e,"/_api/contextinfo");return t._httpClient.fetchRaw(a,{cache:"no-cache",credentials:"same-origin",headers:{Accept:"application/json;odata=verbose","Content-type":"application/json;odata=verbose;charset=utf-8"},method:"POST"}).then(function(e){var t=new r.ODataDefaultParser;return t.parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var o=new i;o.value=n.FormDigestValue;var r=n.FormDigestTimeoutSeconds,s=new Date;return s.setTime(s.getTime()+1e3*r),o.expiration=s,t._digests.add(e,o),o.value})},e.prototype.clear=function(){this._digests.clear()},e}();t.DigestCache=s})},{"../collections/collections":1,"../sharepoint/rest/odata":19,"../utils/util":21}],5:[function(t,n,o){(function(r){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(){}return e.prototype.fetch=function(e,t){return r.fetch(e,t)},e}();t.FetchClient=n})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../util","./ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../util"),o=e("./ObjectHandlerBase"),i=function(e){function t(){e.call(this,"ComposedLook")}return r(t,e),t.prototype.ProvisionObjects=function(t){var o=this;return e.prototype.scope_started.call(this),new Promise(function(r,i){var s=SP.ClientContext.get_current(),a=s.get_web(),c=t.ColorPaletteUrl?n.Util.replaceUrlTokens(t.ColorPaletteUrl):"",u=t.FontSchemeUrl?n.Util.replaceUrlTokens(t.FontSchemeUrl):"",l=t.BackgroundImageUrl?n.Util.replaceUrlTokens(t.BackgroundImageUrl):null;a.applyTheme(n.Util.getRelativeUrl(c),n.Util.getRelativeUrl(u),l,!0),a.update(),s.executeQueryAsync(function(){e.prototype.scope_ended.call(o),r()},function(){e.prototype.scope_ended.call(o),r()})})},t}(o.ObjectHandlerBase);t.ObjectComposedLook=i})},{"../util":18,"./ObjectHandlerBase":10}],7:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("./ObjectHandlerBase"),o=function(e){function t(){e.call(this,"CustomActions")}return r(t,e),t.prototype.ProvisionObjects=function(t){var n=this;return e.prototype.scope_started.call(this),new Promise(function(o,r){var i=SP.ClientContext.get_current(),s=i.get_web().get_userCustomActions();i.load(s),i.executeQueryAsync(function(){t.forEach(function(e){var t=s.get_data().filter(function(t){return t.get_title()===e.Title}).length>0;if(!t){var n=s.add();e.Description&&n.set_description(e.Description),e.CommandUIExtension&&n.set_commandUIExtension(e.CommandUIExtension),e.Group&&n.set_group(e.Group),e.Title&&n.set_title(e.Title),e.Url&&n.set_url(e.Url),e.ScriptBlock&&n.set_scriptBlock(e.ScriptBlock),e.ScriptSrc&&n.set_scriptSrc(e.ScriptSrc),e.Location&&n.set_location(e.Location),e.ImageUrl&&n.set_imageUrl(e.ImageUrl),e.Name&&n.set_name(e.Name),e.RegistrationId&&n.set_registrationId(e.RegistrationId),e.RegistrationType&&n.set_registrationType(e.RegistrationType),e.Rights&&n.set_rights(e.Rights),e.Sequence&&n.set_sequence(e.Sequence),n.update()}}),i.executeQueryAsync(function(){e.prototype.scope_ended.call(n),o()},function(){e.prototype.scope_ended.call(n),o()})},function(){e.prototype.scope_ended.call(n),o()})})},t}(n.ObjectHandlerBase);t.ObjectCustomActions=o})},{"./ObjectHandlerBase":10}],8:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("./ObjectHandlerBase"),o=function(e){function t(){e.call(this,"Features")}return r(t,e),t.prototype.ProvisionObjects=function(t){var n=this;return e.prototype.scope_started.call(this),new Promise(function(o,r){var i=SP.ClientContext.get_current(),s=i.get_web(),a=s.get_features();t.forEach(function(e){e.Deactivate===!0?a.remove(new SP.Guid(e.ID),!0):a.add(new SP.Guid(e.ID),!0,SP.FeatureDefinitionScope.none)}),s.update(),i.load(a),i.executeQueryAsync(function(){e.prototype.scope_ended.call(n),o()},function(){e.prototype.scope_ended.call(n),o()})})},t}(n.ObjectHandlerBase);t.ObjectFeatures=o})},{"./ObjectHandlerBase":10}],9:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../../utils/util","../util","./ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../../../utils/util"),o=e("../util"),i=e("./ObjectHandlerBase"),s=function(e){function t(){e.call(this,"Files")}return r(t,e),t.prototype.ProvisionObjects=function(t){var r=this;return e.prototype.scope_started.call(this),new Promise(function(i,s){var a=SP.ClientContext.get_current(),c=a.get_web(),u=[],l=[];t.forEach(function(e,t){l.push(r.httpClient.fetchRaw(o.Util.replaceUrlTokens(e.Src)).then(function(e){return e.text()}))}),Promise.all(l).then(function(e){e.forEach(function(e,o){var i=t[o],s=r.GetFilenameFromFilePath(i.Dest),l=_spPageContextInfo.webServerRelativeUrl,f=c.getFolderByServerRelativeUrl(l+"/"+r.GetFolderFromFilePath(i.Dest)),p={Contents:e,Dest:i.Dest,Filename:s,Folder:f,Instance:null,Overwrite:!1,Properties:[],RemoveExistingWebParts:!0,ServerRelativeUrl:i.Dest,Src:i.Src,Views:[],WebParts:[]};if(n.Util.extend(p,i),-1===p.Filename.indexOf("Form.aspx")){var d=new SP.FileCreationInformation;d.set_overwrite(p.Overwrite),d.set_url(p.Filename),d.set_content(new SP.Base64EncodedByteArray);for(var y=0;y<p.Contents.length;y++)d.get_content().append(p.Contents.charCodeAt(y));a.load(p.Folder.get_files().add(d)),u.push(p)}})}),a.executeQueryAsync(function(){l=[],u.forEach(function(e){e.Properties&&Object.keys(e.Properties).length>0&&l.push(r.ApplyFileProperties(e.Dest,e.Properties)),e.WebParts&&e.WebParts.length>0&&l.push(r.AddWebPartsToWebPartPage(e.Dest,e.Src,e.WebParts,e.RemoveExistingWebParts))}),Promise.all(l).then(function(){r.ModifyHiddenViews(t).then(function(t){e.prototype.scope_ended.call(r),i(t)},function(t){e.prototype.scope_ended.call(r),s(t)})})},function(t){e.prototype.scope_ended.call(r),s(t)})})},t.prototype.RemoveWebPartsFromFileIfSpecified=function(e,t,n){return new Promise(function(o,r){n||o();var i=t.get_webParts();e.load(i),e.executeQueryAsync(function(){i.get_data().forEach(function(e){e.deleteWebPart()}),e.load(i),e.executeQueryAsync(o,r)},r)})},t.prototype.GetWebPartXml=function(e){var t=this;return new Promise(function(n,r){var i=[];e.forEach(function(e,n){if(e.Contents.FileUrl){var r=o.Util.replaceUrlTokens(e.Contents.FileUrl);i.push(t.httpClient.fetchRaw(r).then(function(e){return e.text()}))}else i.push(function(){return new Promise(function(e,t){e()})}())}),Promise.all(i).then(function(t){t.forEach(function(t,n){var o=e[n];null!==o&&t&&t.length>0&&(o.Contents.Xml=t)}),n(e)})})},t.prototype.AddWebPartsToWebPartPage=function(e,t,n,r){var i=this;return new Promise(function(t,s){var a=SP.ClientContext.get_current(),c=a.get_web(),u=_spPageContextInfo.webServerRelativeUrl+"/"+e,l=c.getFileByServerRelativeUrl(u);a.load(l),a.executeQueryAsync(function(){var e=l.getLimitedWebPartManager(SP.WebParts.PersonalizationScope.shared);i.RemoveWebPartsFromFileIfSpecified(a,e,r).then(function(){i.GetWebPartXml(n).then(function(n){n.forEach(function(t){if(t.Contents.Xml){var n=e.importWebPart(o.Util.replaceUrlTokens(t.Contents.Xml)),r=n.get_webPart();e.addWebPart(r,t.Zone,t.Order)}}),a.executeQueryAsync(t,t)})})},t)})},t.prototype.ApplyFileProperties=function(e,t){return new Promise(function(n,o){var r=SP.ClientContext.get_current(),i=r.get_web(),s=_spPageContextInfo.webServerRelativeUrl+"/"+e,a=i.getFileByServerRelativeUrl(s),c=a.get_listItemAllFields();Object.keys(t).forEach(function(e){c.set_item(e,t[e])}),c.update(),r.executeQueryAsync(n,n)})},t.prototype.GetViewFromCollectionByUrl=function(e,t){for(var n=_spPageContextInfo.webServerRelativeUrl+"/"+t,o=e.getEnumerator();o.moveNext();){var r=o.get_current();if(r.get_serverRelativeUrl().toString().toLowerCase()===n.toLowerCase())return r}return null},t.prototype.ModifyHiddenViews=function(e){var t=this;return new Promise(function(o,r){var i=SP.ClientContext.get_current(),s=i.get_web(),a={},c=[],u=[];e.forEach(function(e){e.Views&&e.Views.forEach(function(t){a[t.List]=a[t.List]||[],a[t.List].push(n.Util.extend(t,{Url:e.Dest}))})}),Object.keys(a).forEach(function(e,t){c.push(s.get_lists().getByTitle(e)),u.push(s.get_lists().getByTitle(e).get_views()),i.load(c[t]),i.load(u[t])}),i.executeQueryAsync(function(){Object.keys(a).forEach(function(e,n){var o=a[e],r=c[n],s=u[n];o.forEach(function(e){var n=t.GetViewFromCollectionByUrl(s,e.Url);if(null!=n){if(e.Paged&&n.set_paged(e.Paged),e.Query&&n.set_viewQuery(e.Query),e.RowLimit&&n.set_rowLimit(e.RowLimit),e.ViewFields&&e.ViewFields.length>0){var o=n.get_viewFields();o.removeAll(),e.ViewFields.forEach(function(e){o.add(e)})}n.update()}}),i.load(s),r.update()}),i.executeQueryAsync(o,o)},o)})},t.prototype.GetFolderFromFilePath=function(e){var t=e.split("/");return t.splice(0,t.length-1).join("/")},t.prototype.GetFilenameFromFilePath=function(e){var t=e.split("/");return t[t.length-1]},t}(i.ObjectHandlerBase);t.ObjectFiles=s})},{"../../../utils/util":21,"../util":18,"./ObjectHandlerBase":10}],10:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../../net/HttpClient","../../../utils/logging"],r)}(function(e,t){"use strict";var n=e("../../../net/HttpClient"),o=e("../../../utils/logging"),r=function(){function e(e){this.name=e,this.httpClient=new n.HttpClient}return e.prototype.ProvisionObjects=function(e,t){return new Promise(function(e,t){e("Not implemented.")})},e.prototype.scope_started=function(){o.Logger.write(this.name+": Code execution scope started")},e.prototype.scope_ended=function(){o.Logger.write(this.name+": Code execution scope stopped")},e}();t.ObjectHandlerBase=r})},{"../../../net/HttpClient":3,"../../../utils/logging":20}],11:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../Sequencer/Sequencer","./ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../Sequencer/Sequencer"),o=e("./ObjectHandlerBase"),i=function(e){function t(){e.call(this,"Lists")}return r(t,e),t.prototype.ProvisionObjects=function(t){var o=this;return e.prototype.scope_started.call(this),new Promise(function(r,i){var s=SP.ClientContext.get_current(),a=s.get_web().get_lists(),c=[];s.load(a),s.executeQueryAsync(function(){t.forEach(function(e,t){var n=a.get_data().filter(function(t){return t.get_title()===e.Title})[0];if(n)e.Description&&n.set_description(e.Description),void 0!==e.EnableVersioning&&n.set_enableVersioning(e.EnableVersioning),void 0!==e.EnableMinorVersions&&n.set_enableMinorVersions(e.EnableMinorVersions),void 0!==e.EnableModeration&&n.set_enableModeration(e.EnableModeration),void 0!==e.EnableFolderCreation&&n.set_enableFolderCreation(e.EnableFolderCreation),void 0!==e.EnableAttachments&&n.set_enableAttachments(e.EnableAttachments),void 0!==e.NoCrawl&&n.set_noCrawl(e.NoCrawl),e.DefaultDisplayFormUrl&&n.set_defaultDisplayFormUrl(e.DefaultDisplayFormUrl),e.DefaultEditFormUrl&&n.set_defaultEditFormUrl(e.DefaultEditFormUrl),e.DefaultNewFormUrl&&n.set_defaultNewFormUrl(e.DefaultNewFormUrl),e.DraftVersionVisibility&&n.set_draftVersionVisibility(SP.DraftVisibilityType[e.DraftVersionVisibility]),e.ImageUrl&&n.set_imageUrl(e.ImageUrl),void 0!==e.Hidden&&n.set_hidden(e.Hidden),void 0!==e.ForceCheckout&&n.set_forceCheckout(e.ForceCheckout),n.update(),c.push(n),s.load(c[t]);else{var o=new SP.ListCreationInformation;if(e.Description&&o.set_description(e.Description),void 0!==e.OnQuickLaunch){var r=e.OnQuickLaunch?SP.QuickLaunchOptions.on:SP.QuickLaunchOptions.off;o.set_quickLaunchOption(r)}e.TemplateType&&o.set_templateType(e.TemplateType),e.Title&&o.set_title(e.Title),e.Url&&o.set_url(e.Url);var i=a.add(o);if(void 0!==e.EnableVersioning&&i.set_enableVersioning(e.EnableVersioning),void 0!==e.EnableMinorVersions&&i.set_enableMinorVersions(e.EnableMinorVersions),void 0!==e.EnableModeration&&i.set_enableModeration(e.EnableModeration),void 0!==e.EnableFolderCreation&&i.set_enableFolderCreation(e.EnableFolderCreation),void 0!==e.EnableAttachments&&i.set_enableAttachments(e.EnableAttachments),void 0!==e.NoCrawl&&i.set_noCrawl(e.NoCrawl),e.DefaultDisplayFormUrl&&i.set_defaultDisplayFormUrl(e.DefaultDisplayFormUrl),e.DefaultEditFormUrl&&i.set_defaultEditFormUrl(e.DefaultEditFormUrl),e.DefaultNewFormUrl&&i.set_defaultNewFormUrl(e.DefaultNewFormUrl),e.DraftVersionVisibility){var r=SP.DraftVisibilityType[e.DraftVersionVisibility.toLocaleLowerCase()];i.set_draftVersionVisibility(r)}e.ImageUrl&&i.set_imageUrl(e.ImageUrl),void 0!==e.Hidden&&i.set_hidden(e.Hidden),void 0!==e.ForceCheckout&&i.set_forceCheckout(e.ForceCheckout),c.push(i),s.load(c[t])}}),s.executeQueryAsync(function(){var i=new n.Sequencer([o.ApplyContentTypeBindings,o.ApplyListInstanceFieldRefs,o.ApplyFields,o.ApplyLookupFields,o.ApplyListSecurity,o.CreateViews,o.InsertDataRows,o.CreateFolders],{ClientContext:s,ListInstances:c,Objects:t},o);i.execute().then(function(){e.prototype.scope_ended.call(o),r()})},function(){e.prototype.scope_ended.call(o),r()})},function(){e.prototype.scope_ended.call(o),r()})})},t.prototype.EnsureLocationBasedMetadataDefaultsReceiver=function(e,t){var n=t.get_eventReceivers(),o=new SP.EventReceiverDefinitionCreationInformation;o.set_receiverName("LocationBasedMetadataDefaultsReceiver ItemAdded"),o.set_synchronization(1),o.set_sequenceNumber(1e3),o.set_receiverAssembly("Microsoft.Office.DocumentManagement, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"),o.set_receiverClass("Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver"),o.set_eventType(SP.EventReceiverType.itemAdded),n.add(o),t.update()},t.prototype.CreateFolders=function(e){var t=this;return new Promise(function(n,o){e.ListInstances.forEach(function(n,o){var r=e.Objects[o];if(r.Folders){var i=_spPageContextInfo.webServerRelativeUrl+"/"+r.Url,s=n.get_rootFolder(),a="<MetadataDefaults>",c=!1;if(r.Folders.forEach(function(e){var t=i+"/"+e.Name;if(s.get_folders().add(t),e.DefaultValues){var n=Object.keys(e.DefaultValues).length;n>0&&(a+="<a href='"+t+"'>",Object.keys(e.DefaultValues).forEach(function(t){a+='<DefaultValue FieldName="'+t+'">'+e.DefaultValues[t]+"</DefaultValue>"}),a+="</a>"),c=!0}}),a+="</MetadataDefaults>",c){var u=new SP.FileCreationInformation;u.set_url(i+"/Forms/client_LocationBasedDefaults.html"),u.set_content(new SP.Base64EncodedByteArray),u.set_overwrite(!0);for(var l=0;l<a.length;l++)u.get_content().append(a.charCodeAt(l));s.get_files().add(u),t.EnsureLocationBasedMetadataDefaultsReceiver(e.ClientContext,n)}}}),e.ClientContext.executeQueryAsync(n,n)})},t.prototype.ApplyContentTypeBindings=function(e){return new Promise(function(t,n){var o=e.ClientContext.get_site().get_rootWeb().get_contentTypes(),r=[];e.ListInstances.forEach(function(t,n){r.push(t.get_contentTypes()),e.ClientContext.load(r[n],"Include(Name,Id)"),e.Objects[n].ContentTypeBindings&&(t.set_contentTypesEnabled(!0),t.update())}),e.ClientContext.load(o),e.ClientContext.executeQueryAsync(function(){e.ListInstances.forEach(function(t,n){var i=e.Objects[n];if(i.ContentTypeBindings){var s=r[n],a=new Array;if(i.RemoveExistingContentTypes&&i.ContentTypeBindings.length>0&&s.get_data().forEach(function(e){a.push(e)}),i.ContentTypeBindings.forEach(function(e){s.addExistingContentType(o.getById(e.ContentTypeId))}),i.RemoveExistingContentTypes&&i.ContentTypeBindings.length>0)for(var c=0;c<a.length;c++){var u=a[c];u.deleteObject()}t.update()}}),e.ClientContext.executeQueryAsync(t,t)},t)})},t.prototype.ApplyListInstanceFieldRefs=function(e){return new Promise(function(t,n){var o=e.ClientContext.get_site().get_rootWeb().get_fields();e.ListInstances.forEach(function(t,n){var r=e.Objects[n];r.FieldRefs&&(r.FieldRefs.forEach(function(e){var n=o.getByInternalNameOrTitle(e.Name);t.get_fields().add(n)}),t.update())}),e.ClientContext.executeQueryAsync(t,t)})},t.prototype.ApplyFields=function(e){var t=this;return new Promise(function(n,o){e.ListInstances.forEach(function(n,o){var r=e.Objects[o];r.Fields&&(r.Fields.forEach(function(o){var r=t.GetFieldXml(o,e.ListInstances,n),i=t.GetFieldXmlAttr(r,"Type");"Lookup"!==i&&"LookupMulti"!==i&&n.get_fields().addFieldAsXml(r,!0,SP.AddFieldOptions.addToAllContentTypes)}),n.update())}),e.ClientContext.executeQueryAsync(n,n)})},t.prototype.ApplyLookupFields=function(e){var t=this;return new Promise(function(n,o){e.ListInstances.forEach(function(n,o){var r=e.Objects[o];r.Fields&&(r.Fields.forEach(function(o){var r=t.GetFieldXml(o,e.ListInstances,n);if(r){var i=t.GetFieldXmlAttr(r,"Type");"Lookup"!==i&&"LookupMulti"!==i||n.get_fields().addFieldAsXml(r,!0,SP.AddFieldOptions.addToAllContentTypes)}}),n.update())}),e.ClientContext.executeQueryAsync(n,n)})},t.prototype.GetFieldXmlAttr=function(e,t){var n=new RegExp(t+"=['|\"](?:(.+?))['|\"]"),o=n.exec(e);return o[1]},t.prototype.GetFieldXml=function(e,t,n){var o="";if(!e.SchemaXml){var r=[];Object.keys(e).forEach(function(n){var o=e[n];if("List"===n){var i=t.filter(function(e){return e.get_title()===o});if(!(i.length>0))return null;o="{"+i[0].get_id().toString()+"}",r.push(n+'="'+o+'"')}}),o="<Field "+r.join(" ")+">","Calculated"===e.Type&&(o+="<Formula>"+e.Formula+"</Formula>"),o+="</Field>"}return o},t.prototype.ApplyListSecurity=function(e){return new Promise(function(t,n){e.ListInstances.forEach(function(t,n){var o=e.Objects[n];o.Security&&o.Security.BreakRoleInheritance&&(t.breakRoleInheritance(o.Security.CopyRoleAssignments,o.Security.ClearSubscopes),t.update(),e.ClientContext.load(t.get_roleAssignments()))});var o=e.ClientContext.get_web(),r=o.get_allProperties(),i=o.get_siteGroups(),s=o.get_roleDefinitions();e.ClientContext.load(r),e.ClientContext.load(s),e.ClientContext.executeQueryAsync(function(){e.ListInstances.forEach(function(t,n){var o=e.Objects[n];o.Security&&(o.Security.RoleAssignments.forEach(function(n){var o=null;o="number"==typeof n.RoleDefinition?s.getById(n.RoleDefinition):s.getByName(n.RoleDefinition);var a=SP.RoleDefinitionBindingCollection.newObject(e.ClientContext);a.add(o);var c=null;if(n.Principal.match(/\{[A-Za-z]*\}+/g)){var u=n.Principal.substring(1,n.Principal.length-1),l=r.get_fieldValues()["vti_"+u];c=i.getById(l)}else c=i.getByName(c);t.get_roleAssignments().add(c,a)}),t.update())}),e.ClientContext.executeQueryAsync(t,t)},t)})},t.prototype.CreateViews=function(e){return new Promise(function(t,n){var o=[];e.ListInstances.forEach(function(t,n){o.push(t.get_views()),e.ClientContext.load(o[n])}),e.ClientContext.executeQueryAsync(function(){e.ListInstances.forEach(function(t,n){var r=e.Objects[n];r.Views&&(o.push(t.get_views()),e.ClientContext.load(o[n]),r.Views.forEach(function(i){var s=o[n].get_data().filter(function(e){return r.RemoveExistingViews&&r.Views.length>0?(e.deleteObject(),!1):e.get_title()===i.Title}).length>0;if(s){var a=o[n].getByTitle(i.Title);if(i.Paged&&a.set_paged(i.Paged),i.Query&&a.set_viewQuery(i.Query),i.RowLimit&&a.set_rowLimit(i.RowLimit),i.ViewFields&&i.ViewFields.length>0){var c=a.get_viewFields();c.removeAll(),i.ViewFields.forEach(function(e){c.add(e)})}i.Scope&&a.set_scope(i.Scope),a.update()}else{var u=new SP.ViewCreationInformation;i.Title&&u.set_title(i.Title),i.PersonalView&&u.set_personalView(i.PersonalView),i.Paged&&u.set_paged(i.Paged),i.Query&&u.set_query(i.Query),i.RowLimit&&u.set_rowLimit(i.RowLimit),i.SetAsDefaultView&&u.set_setAsDefaultView(i.SetAsDefaultView),i.ViewFields&&u.set_viewFields(i.ViewFields),i.ViewTypeKind&&u.set_viewTypeKind(SP.ViewType.html);var a=t.get_views().add(u);i.Scope&&(a.set_scope(i.Scope),a.update()),t.update()}e.ClientContext.load(t.get_views())}))}),e.ClientContext.executeQueryAsync(t,t)},t)})},t.prototype.InsertDataRows=function(e){return new Promise(function(t,n){e.ListInstances.forEach(function(t,n){var o=e.Objects[n];o.DataRows&&o.DataRows.forEach(function(n){var o=t.addItem(new SP.ListItemCreationInformation);Object.keys(n).forEach(function(e){o.set_item(e,n[e])}),o.update(),e.ClientContext.load(o)})}),e.ClientContext.executeQueryAsync(t,t)})},t}(o.ObjectHandlerBase);t.ObjectLists=i})},{"../Sequencer/Sequencer":16,"./ObjectHandlerBase":10}],12:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../util","./ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../util"),o=e("./ObjectHandlerBase"),i=function(e){function t(){e.call(this,"Navigation")}return r(t,e),t.prototype.ProvisionObjects=function(t){var n=this;e.prototype.scope_started.call(this);var o=SP.ClientContext.get_current(),r=o.get_web().get_navigation();return new Promise(function(i,s){n.ConfigureQuickLaunch(t.QuickLaunch,o,n.httpClient,r).then(function(){e.prototype.scope_ended.call(n),i()},function(){e.prototype.scope_ended.call(n),s()})})},t.prototype.getNodeFromCollectionByTitle=function(e,t){var n=e.filter(function(e){return e.get_title()===t});return n[0]||null},t.prototype.ConfigureQuickLaunch=function(e,t,o,r){var i=this;return new Promise(function(s,a){if(0===e.length)s();else{var c=r.get_quickLaunch();t.load(c),t.executeQueryAsync(function(){for(var a=[],u=c.get_count()-1;u>=0;){var l=c.itemAt(u);a.push(l),l.deleteObject(),u--}t.executeQueryAsync(function(){e.forEach(function(e){var t=i.getNodeFromCollectionByTitle(a,e.Title),o=new SP.NavigationNodeCreationInformation;o.set_title(e.Title),o.set_url(t?t.get_url():n.Util.replaceUrlTokens(e.Url)),o.set_asLastNode(!0),c.add(o)}),t.executeQueryAsync(function(){o.get(_spPageContextInfo.webAbsoluteUrl+"/_api/web/Navigation/QuickLaunch").then(function(o){o.json().then(function(o){o.value.forEach(function(t){var o=r.getNodeById(t.Id),s=o.get_children(),c=e.filter(function(e){return e.Title===t.Title})[0];c&&c.Children&&c.Children.forEach(function(e){var t=i.getNodeFromCollectionByTitle(a,e.Title),o=new SP.NavigationNodeCreationInformation;o.set_title(e.Title),o.set_url(t?t.get_url():n.Util.replaceUrlTokens(e.Url)),o.set_asLastNode(!0),s.add(o)})}),t.executeQueryAsync(s,s)})})},s)})})}})},t}(o.ObjectHandlerBase);t.ObjectNavigation=i})},{"../util":18,"./ObjectHandlerBase":10}],13:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../util","./ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("../util"),o=e("./ObjectHandlerBase"),i=function(e){function t(){e.call(this,"PropertyBagEntries")}return r(t,e),t.prototype.ProvisionObjects=function(t){var o=this;return e.prototype.scope_started.call(this),new Promise(function(r,i){if(t&&0!==t.length){for(var s=SP.ClientContext.get_current(),a=s.get_web(),c=a.get_allProperties(),u=[],l=0;l<t.length;l++){var f=t[l];c.set_item(f.Key,f.Value),f.Indexed&&u.push(n.Util.encodePropertyKey(f.Key))}a.update(),s.load(c),s.executeQueryAsync(function(){u.length>0?(c.set_item("vti_indexedpropertykeys",u.join("|")),a.update(),s.executeQueryAsync(function(){e.prototype.scope_ended.call(o),r()},function(){e.prototype.scope_ended.call(o),r()})):(e.prototype.scope_ended.call(o),r())},function(){e.prototype.scope_ended.call(o),r()})}else r()})},t}(o.ObjectHandlerBase);t.ObjectPropertyBagEntries=i})},{"../util":18,"./ObjectHandlerBase":10}],14:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./ObjectHandlerBase"],r)}(function(e,t){"use strict";var n=e("./ObjectHandlerBase"),o=function(e){function t(){e.call(this,"WebSettings")}return r(t,e),t.prototype.ProvisionObjects=function(t){var n=this;return e.prototype.scope_started.call(this),new Promise(function(o,r){var i=SP.ClientContext.get_current(),s=i.get_web();t.WelcomePage&&(s.get_rootFolder().set_welcomePage(t.WelcomePage),s.get_rootFolder().update()),t.MasterUrl&&s.set_masterUrl(t.MasterUrl),t.CustomMasterUrl&&s.set_customMasterUrl(t.CustomMasterUrl),void 0!==t.SaveSiteAsTemplateEnabled&&s.set_saveSiteAsTemplateEnabled(t.SaveSiteAsTemplateEnabled),void 0!==t.QuickLaunchEnabled&&s.set_saveSiteAsTemplateEnabled(t.QuickLaunchEnabled),void 0!==t.TreeViewEnabled&&s.set_treeViewEnabled(t.TreeViewEnabled),s.update(),i.load(s),i.executeQueryAsync(function(){
e.prototype.scope_ended.call(n),o()},function(){e.prototype.scope_ended.call(n),o()})})},t}(n.ObjectHandlerBase);t.ObjectWebSettings=o})},{"./ObjectHandlerBase":10}],15:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(e,t,n,o,r){this.name=e,this.index=t,this.objects=n,this.parameters=o,this.handler=r}return e.prototype.execute=function(e){var t=this,n=new this.handler;return e?new Promise(function(o,r){e.then(function(){return n.ProvisionObjects(t.objects,t.parameters).then(o,o)})}):n.ProvisionObjects(this.objects,this.parameters)},e}();t.ProvisioningStep=n})},{}],16:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(e,t,n){this.functions=e,this.parameter=t,this.scope=n}return e.prototype.execute=function(e){var t=Promise.resolve();return this.functions.forEach(function(n,o){t=t.then(function(){return n.call(this.scope,this.parameter)}).then(function(t){e&&e.call(this,o,this.functions)})},this),t},e}();t.Sequencer=n})},{}],17:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","./ProvisioningStep","./ObjectHandlers/ObjectNavigation","./ObjectHandlers/ObjectPropertyBagEntries","./ObjectHandlers/ObjectFeatures","./ObjectHandlers/ObjectWebSettings","./ObjectHandlers/ObjectComposedLook","./ObjectHandlers/ObjectCustomActions","./ObjectHandlers/ObjectFiles","./ObjectHandlers/ObjectLists","./util","../../utils/logging","../../net/HttpClient"],r)}(function(e,t){"use strict";var n=e("./ProvisioningStep"),o=e("./ObjectHandlers/ObjectNavigation"),r=e("./ObjectHandlers/ObjectPropertyBagEntries"),i=e("./ObjectHandlers/ObjectFeatures"),s=e("./ObjectHandlers/ObjectWebSettings"),a=e("./ObjectHandlers/ObjectComposedLook"),c=e("./ObjectHandlers/ObjectCustomActions"),u=e("./ObjectHandlers/ObjectFiles"),l=e("./ObjectHandlers/ObjectLists"),f=e("./util"),p=e("../../utils/logging"),d=e("../../net/HttpClient"),y=function(){function e(){this.handlers={Navigation:o.ObjectNavigation,PropertyBagEntries:r.ObjectPropertyBagEntries,Features:i.ObjectFeatures,WebSettings:s.ObjectWebSettings,ComposedLook:a.ObjectComposedLook,CustomActions:c.ObjectCustomActions,Files:u.ObjectFiles,Lists:l.ObjectLists},this.httpClient=new d.HttpClient}return e.prototype.applyTemplate=function(e){var t=this,n=f.Util.replaceUrlTokens(e);return new Promise(function(e,o){t.httpClient.get(n).then(function(n){n.ok?n.json().then(function(n){t.start(n,Object.keys(n)).then(e,o)}):o(n.statusText)},function(e){p.Logger.write("Provisioning: The provided template is invalid",p.Logger.LogLevel.Error)})})},e.prototype.start=function(e,t){var o=this;return new Promise(function(r,i){o.startTime=(new Date).getTime(),o.queueItems=[],t.forEach(function(t,r){o.handlers[t]&&o.queueItems.push(new n.ProvisioningStep(t,r,e[t],e.Parameters,o.handlers[t]))});var s=[];s.push(new Promise(function(e){p.Logger.write("Provisioning: Code execution scope started",p.Logger.LogLevel.Info),e()}));for(var a=1;void 0!==o.queueItems[a-1];){var c=s.length-1;s.push(o.queueItems[a-1].execute(s[c])),a++}Promise.all(s).then(function(e){p.Logger.write("Provisioning: Code execution scope ended",p.Logger.LogLevel.Info),r(e)},function(e){p.Logger.write("Provisioning: Code execution scope ended"+JSON.stringify(e),p.Logger.LogLevel.Error),i(e)})})},e}();t.Provisioning=y})},{"../../net/HttpClient":3,"../../utils/logging":20,"./ObjectHandlers/ObjectComposedLook":6,"./ObjectHandlers/ObjectCustomActions":7,"./ObjectHandlers/ObjectFeatures":8,"./ObjectHandlers/ObjectFiles":9,"./ObjectHandlers/ObjectLists":11,"./ObjectHandlers/ObjectNavigation":12,"./ObjectHandlers/ObjectPropertyBagEntries":13,"./ObjectHandlers/ObjectWebSettings":14,"./ProvisioningStep":15,"./util":18}],18:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(){}return e.getRelativeUrl=function(e){return e.replace(document.location.protocol+"//"+document.location.hostname,"")},e.replaceUrlTokens=function(e){return e.replace(/{site}/g,_spPageContextInfo.webAbsoluteUrl).replace(/{sitecollection}/g,_spPageContextInfo.siteAbsoluteUrl).replace(/{themegallery}/g,_spPageContextInfo.siteAbsoluteUrl+"/_catalogs/theme/15")},e.encodePropertyKey=function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n)),t.push(0);var o=window.btoa(String.fromCharCode.apply(null,t));return o},e}();t.Util=n})},{}],19:[function(t,n,o){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports","../../utils/util","../../utils/logging"],r)}(function(e,t){"use strict";function n(e){return e.hasOwnProperty("__metadata")?e.__metadata.uri:e.hasOwnProperty("odata.editLink")?a.Util.combinePaths("_api",e["odata.editLink"]):(c.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",c.Logger.LogLevel.Warning),"")}function o(){return new p}function i(e){return new d(e)}function s(e){return new y(e)}var a=e("../../utils/util"),c=e("../../utils/logging"),u=function(){function e(){}return e.prototype.parse=function(e){return e.json().then(function(e){return e.hasOwnProperty("d")?e.d.hasOwnProperty("results")?e.d.results:e.d:e.hasOwnProperty("value")?e.value:e})},e}();t.ODataParserBase=u;var l=function(e){function t(){e.apply(this,arguments)}return r(t,e),t}(u);t.ODataDefaultParser=l;var f=function(){function e(){}return e.prototype.parse=function(e){return e.json()},e}();t.ODataRawParserImpl=f;var p=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.parse=function(t){return e.prototype.parse.call(this,t).then(function(e){return e})},t}(u),d=function(e){function t(t){e.call(this),this.factory=t}return r(t,e),t.prototype.parse=function(t){var o=this;return e.prototype.parse.call(this,t).then(function(e){var t=new o.factory(n(e),null);return a.Util.extend(t,e)})},t}(u),y=function(e){function t(t){e.call(this),this.factory=t}return r(t,e),t.prototype.parse=function(t){var o=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new o.factory(n(e),null);return a.Util.extend(t,e)})})},t}(u);t.ODataRaw=new f,t.ODataValue=o,t.ODataEntity=i,t.ODataEntityArray=s})},{"../../utils/logging":20,"../../utils/util":21}],20:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return"undefined"!=typeof e._instance&&null!==e._instance||(e._instance=new o),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];for(var o=0;o<t.length;o++)e.instance.subscribe(t[o])},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=e.LogLevel.Verbose),e.instance.log({level:n,message:t})},e.log=function(t){e.instance.log(t)},e.measure=function(t,n){return e.instance.measure(t,n)},e}();t.Logger=n;var n,o=function(){function e(e,t){void 0===e&&(e=n.LogLevel.Warning),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=n.LogLevel.Verbose),this.log({level:t,message:e})},e.prototype.log=function(e){if(!("undefined"==typeof e||e.level<this.activeLogLevel))for(var t=0;t<this.subscribers.length;t++)this.subscribers[t].log(e)},e.prototype.measure=function(e,t){console.profile(e);try{return t()}finally{console.profileEnd()}},e}();!function(e){!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(e.LogLevel||(e.LogLevel={}));var t=e.LogLevel,n=function(){function e(){}return e.prototype.log=function(e){var n=this.format(e);switch(e.level){case t.Verbose:case t.Info:console.log(n);break;case t.Warning:console.warn(n);break;case t.Error:console.error(n)}},e.prototype.format=function(e){return"Message: "+e.message+". Data: "+JSON.stringify(e.data)},e}();e.ConsoleListener=n;var o=function(){function e(e){this.azureInsightsInstrumentationKey=e;var t=window.appInsights||function(e){function t(e){r[e]=function(){var t=arguments;r.queue.push(function(){r[e].apply(r,t)})}}var n,o,r={config:e},i=document,s=window,a="script",c=i.createElement(a);for(c.src=e.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",i.getElementsByTagName(a)[0].parentNode.appendChild(c),r.cookie=i.cookie,r.queue=[],n=["Event","Exception","Metric","PageView","Trace"];n.length;)t("track"+n.pop());return t("setAuthenticatedUserContext"),t("clearAuthenticatedUserContext"),e.disableExceptionTracking||(n="onerror",t("_"+n),o=s[n],s[n]=function(e,t,i,s,a){var c=o&&o(e,t,i,s,a);return c!==!0&&r["_"+n](e,t,i,s,a),c}),r}({instrumentationKey:this.azureInsightsInstrumentationKey});window.appInsights=t}return e.prototype.log=function(e){var n=window.appInsights,o=this.format(e);e.level===t.Error?n.trackException(o):n.trackEvent(o)},e.prototype.format=function(e){return"Message: "+e.message+". Data: "+JSON.stringify(e.data)},e}();e.AzureInsightsListener=o;var r=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}();e.FunctionListener=r}(n=t.Logger||(t.Logger={}))})},{}],21:[function(t,n,o){!function(r){if("object"==typeof n&&"object"==typeof n.exports){var i=r(t,o);void 0!==i&&(n.exports=i)}else"function"==typeof e&&e.amd&&e(["require","exports"],r)}(function(e,t){"use strict";var n=function(){function e(){}return e.getCtxCallback=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return function(){t.apply(e,n)}},e.urlParamExists=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)");return t.test(location.search)},e.getUrlParamByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))},e.getUrlParamBoolByName=function(e){var t=this.getUrlParamByName(e),n=""===t||/false|0/i.test(t);return!n},e.stringInsert=function(e,t,n){return t>0?e.substring(0,t)+n+e.substring(t,e.length):n+e},e.dateAdd=function(e,t,n){var o=new Date(e.toLocaleString());switch(t.toLowerCase()){case"year":o.setFullYear(o.getFullYear()+n);break;case"quarter":o.setMonth(o.getMonth()+3*n);break;case"month":o.setMonth(o.getMonth()+n);break;case"week":o.setDate(o.getDate()+7*n);break;case"day":o.setDate(o.getDate()+n);break;case"hour":o.setTime(o.getTime()+36e5*n);break;case"minute":o.setTime(o.getTime()+6e4*n);break;case"second":o.setTime(o.getTime()+1e3*n);break;default:o=void 0}return o},e.loadStylesheet=function(e,t){t&&(e+="?"+encodeURIComponent((new Date).getTime().toString()));var n=document.getElementsByTagName("head");if(n.length>0){var o=document.createElement("link");n[0].appendChild(o),o.setAttribute("type","text/css"),o.setAttribute("rel","stylesheet"),o.setAttribute("href",e)}},e.combinePaths=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];for(var n=[],o=0;o<e.length;o++)"undefined"!=typeof e[o]&&null!==e[o]&&n.push(e[o].replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,""));return n.join("/").replace(/\\/,"/")},e.getRandomString=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;e>o;o++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},e.getGUID=function(){var e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)});return t},e.isFunction=function(e){return"function"==typeof e},e.isArray=function(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array},e.stringIsNullOrEmpty=function(e){return"undefined"==typeof e||null===e||""===e},e.extend=function(e,t,n){void 0===n&&(n=!1);var o={};for(var r in e)o[r]=e[r];var i=n?function(e,t){return!e.hasOwnProperty(t)}:function(e,t){return!0};for(var r in t)i(o,r)&&(o[r]=t[r]);return o},e.applyMixins=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(n){e.prototype[n]=t.prototype[n]})})},e.isUrlAbsolute=function(e){return/^https?:\/\/|^\/\//i.test(e)},e}();t.Util=n})},{}]},{},[17])(17)});
//# sourceMappingURL=pnp-provisioning.min.js.map
